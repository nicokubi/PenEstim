<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title> • penetrance</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">penetrance</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/README.html">UNKNOWN TITLE</a>
    </li>
    <li>
      <a href="../articles/simulation_study_real.html">Simulation study from empirical data with penetrance</a>
    </li>
    <li>
      <a href="../articles/simulation_study.html">Simulation Study with penetrance</a>
    </li>
    <li>
      <a href="../articles/using_penetrance.html">Penetrance Estimation with penetrance</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/nicokubi/penetrance/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip></h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/nicokubi/penetrance/blob/HEAD/vignettes/README.Rmd" class="external-link"><code>vignettes/README.Rmd</code></a></small>
      <div class="hidden name"><code>README.Rmd</code></div>

    </div>

    
    
<!-- README.md is generated from README.Rmd. Please edit that file -->
<div class="section level2">
<h2 id="penetrance-r-package">Penetrance R package<a class="anchor" aria-label="anchor" href="#penetrance-r-package"></a>
</h2>
<p>An R package for the estimation of age-specific penetrance for complex family-based studies in a format compatible with with the PanelPRO R package.</p>
<div class="section level3">
<h3 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h3>
<p>To install, use</p>
<pre><code>git clone git@github.com:nicokubi/penetrance.git</code></pre>
<p>Open the source directory as new R project and install the package with</p>
<pre><code><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org/reference/install.html" class="external-link">install</a></span><span class="op">(</span><span class="op">)</span></span></code></pre>
<p>or directly in R studio</p>
<pre><code><span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"https://github.com/nicokubi/penetrance"</span><span class="op">)</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="quick-start-guide">Quick-start guide<a class="anchor" aria-label="anchor" href="#quick-start-guide"></a>
</h3>
<p>This following is a quick-start guide for basic usage of the package. For greater detail on options, please refer to the other vignettes <a href="">using_penetrance</a> and documentation.</p>
<p>The primary function in the package is <code>PenEstim</code>. The package workflow includes three main parts: user input, including family data in the form of pedigrees and specification for the penetrance estimation, the estimation of the posterior distribution using the MCMC approach, and the outputting of the results in the form of the samples from the approximated posterior distribution, i.e. the estimated penetrance function.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/nicokubi/penetrance" class="external-link">penetrance</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: clipp</span></span>
<span><span class="co">#&gt; Loading required package: parallel</span></span>
<span><span class="co">#&gt; Loading required package: MASS</span></span>
<span><span class="co">#&gt; Loading required package: kinship2</span></span>
<span><span class="co">#&gt; Warning: package 'kinship2' was built under R version 4.2.3</span></span>
<span><span class="co">#&gt; Loading required package: Matrix</span></span>
<span><span class="co">#&gt; Loading required package: quadprog</span></span></code></pre></div>
<div class="section level4">
<h4 id="pedigree">Pedigree<a class="anchor" aria-label="anchor" href="#pedigree"></a>
</h4>
<p>The user must specify the <code>pedigree</code> argument as a data frame with the following columns:</p>
<ul>
<li>
<code>ID</code>: A numeric value representing the unique identifier for each individual. There should be no duplicated entries.</li>
<li>
<code>Sex</code>: A numeric value where <code>0</code> indicates female and <code>1</code> indicates male. Missing entries are not currently supported.</li>
<li>
<code>MotherID</code>: A numeric value representing the unique identifier for an individual’s mother.</li>
<li>
<code>FatherID</code>: A numeric value representing the unique identifier for an individual’s father.</li>
<li>
<code>isProband</code>: A numeric value where <code>1</code> indicates the individual is a proband and <code>0</code> otherwise.</li>
<li>
<code>CurAge</code>: A numeric value indicating the age of censoring (current age if the person is alive or age at death if the person is deceased). Allowed ages range from <code>1</code> to <code>94</code>.</li>
<li>
<code>isAff</code>: A numeric value indicating the affection status of cancer, with <code>1</code> for diagnosed individuals and <code>0</code> otherwise. Missing entries are not supported.</li>
<li>
<code>Age</code>: A numeric value indicating the age of cancer diagnosis, encoded as <code>NA</code> if the individual was not diagnosed. Allowed ages range from <code>1</code> to <code>94</code>.</li>
<li>
<code>Geno</code>: A column for germline testing or tumor marker testing results. Positive results should be coded as <code>1</code>, negative results as <code>0</code>, and unknown results as <code>NA</code> or left empty.</li>
</ul>
</div>
<div class="section level4">
<h4 id="model-specification">Model specification<a class="anchor" aria-label="anchor" href="#model-specification"></a>
</h4>
<p>There are a few ways in which a user can specify how the estimation approach is run. Available options are:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#' @param pedigree A data frame containing the pedigree data in the required format. It should include the following columns:</span></span>
<span><span class="co">#'   - `PedigreeID`:  A numeric value representing the unique identifier for each family There should be no duplicated entries.</span></span>
<span><span class="co">#'   - `ID`: A numeric value representing the unique identifier for each individual. There should be no duplicated entries.</span></span>
<span><span class="co">#'   - `Sex`: A numeric value where `0` indicates female and `1` indicates male. Missing entries are not currently supported.</span></span>
<span><span class="co">#'   - `MotherID`: A numeric value representing the unique identifier for an individual's mother.</span></span>
<span><span class="co">#'   - `FatherID`: A numeric value representing the unique identifier for an individual's father.</span></span>
<span><span class="co">#'   - `isProband`: A numeric value where `1` indicates the individual is a proband and `0` otherwise.</span></span>
<span><span class="co">#'   - `CurAge`: A numeric value indicating the age of censoring (current age if the person is alive or age at death if the person is deceased). Allowed ages range from `1` to `94`.</span></span>
<span><span class="co">#'   - `isAff`: A numeric value indicating the affection status of cancer, with `1` for diagnosed individuals and `0` otherwise. Missing entries are not supported.</span></span>
<span><span class="co">#'   - `Age`: A numeric value indicating the age of cancer diagnosis, encoded as `NA` if the individual was not diagnosed. Allowed ages range from `1` to `94`.</span></span>
<span><span class="co">#'   - `Geno`: A column for germline testing or tumor marker testing results. Positive results should be coded as `1`, negative results as `0`, and unknown results as `NA` or left empty.</span></span>
<span><span class="co">#' @param twins Identical twins or triplets in the family can be specifed. For example, to indicate that `ora024` and `ora027` are identical twins, and so are `aey063` and `aey064`, </span></span>
<span><span class="co">#' then we can use the following as the twins arguement: twins &lt;- list(c("ora024", "ora027"), c("aey063", "aey064"))</span></span>
<span><span class="co">#' @param n_chains Number of chains for parallel computation. Default is 1.</span></span>
<span><span class="co">#' @param n_iter_per_chain Number of iterations for each chain. Default is 10000.</span></span>
<span><span class="co">#' @param ncores Number of cores for parallel computation. Default is 6.</span></span>
<span><span class="co">#' @param baseline_data Data for the baseline risk estimates (probability of developing cancer), such as population-level risk from a cancer registry. Default is the allele frequency for MLH1 from the PanelPRO database.</span></span>
<span><span class="co">#' @param max_age Maximum age considered for analysis. Default is 94.</span></span>
<span><span class="co">#' @param removeProband Logical, indicating whether to remove probands from the analysis. Default is FALSE.</span></span>
<span><span class="co">#' @param ageImputation Logical, indicating whether to perform age imputation. Default is FALSE.</span></span>
<span><span class="co">#' @param median_max Boolean indicating whether to use the baseline median age or max_age as an upper bound for the median proposal. Default is TRUE.</span></span>
<span><span class="co">#' @param BaselineNC Boolean indicating that the non-carrier penetrance is assumed to be the baseline penetrance. Default is TRUE.</span></span>
<span><span class="co">#' @param var Vector of variances for the proposal distribution. Default is c(0.1, 0.1, 2, 2, 5, 5, 5, 5).</span></span>
<span><span class="co">#' @param burn_in Fraction of results to discard as burn-in (0 to 1). Default is 0 (no burn-in).</span></span>
<span><span class="co">#' @param thinning_factor Factor by which to thin the results. Default is 1 (no thinning).</span></span>
<span><span class="co">#' @param distribution_data Data for generating prior distributions.</span></span>
<span><span class="co">#' @param af Allele frequency for the risk allele. Default is 0.0001.</span></span>
<span><span class="co">#' @param max_penetrance Maximum penetrance considered for analysis. Default is 1.</span></span>
<span><span class="co">#' @param sample_size Optional sample size for distribution generation.</span></span>
<span><span class="co">#' @param ratio Optional ratio parameter for distribution generation.</span></span>
<span><span class="co">#' @param prior_params Parameters for prior distributions.</span></span>
<span><span class="co">#' @param risk_proportion Proportion of risk for distribution generation.</span></span>
<span><span class="co">#' @param summary_stats Boolean indicating whether to include summary statistics in the output. Default is TRUE.</span></span>
<span><span class="co">#' @param rejection_rates Boolean indicating whether to include rejection rates in the output. Default is TRUE.</span></span>
<span><span class="co">#' @param density_plots Boolean indicating whether to include density plots in the output. Default is TRUE.</span></span>
<span><span class="co">#' @param plot_trace Boolean indicating whether to include trace plots in the output. Default is TRUE.</span></span>
<span><span class="co">#' @param penetrance_plot Boolean indicating whether to include penetrance plots in the output. Default is TRUE.</span></span>
<span><span class="co">#' @param penetrance_plot_pdf Boolean indicating whether to include PDF plots in the output. Default is TRUE.</span></span>
<span><span class="co">#' @param probCI Probability level for confidence intervals in penetrance plots. Default is 0.95.</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="prior-specification">Prior Specification<a class="anchor" aria-label="anchor" href="#prior-specification"></a>
</h4>
Penetrance provides the user with a flexible approach to prior specification, balancing customization with an easy-to-use workflow. In addition to providing default prior distributions, the package allows users to customize the priors by including existing penetrance estimates or prior knowledge. The following settings for the prior distribution specification are available:
</div>
<div class="section level4">
<h4 id="additional-user-inputs">Additional User Inputs<a class="anchor" aria-label="anchor" href="#additional-user-inputs"></a>
</h4>
<ul>
<li><p>The <code>PenEstim</code> function takes baseline age-specific probabilitie of developing cancer as as input <code>baseline_data</code>. In the default setting with <code>BaselineNC = TRUE</code> this baseline is assumed to reflect the non-carrier penetrance. For rare mutations this is considered a reasonable assumption. The baseline_data must be a data frame with baseline data for females and males.</p></li>
<li><p>Furthermore the specification of the allele frequency of the pathogenic variant (<code>af</code>) is required.</p></li>
<li><p>The PenEsim also includes an option for automatic age imputation <code>AgeImputation</code>. We apply an age imputation as part of the MCMC routine. The imputation of ages is performed based on the individual’s affected status (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi><mi>f</mi><mi>f</mi></mrow><annotation encoding="application/x-tex">aff</annotation></semantics></math>), sex (<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi><mi>e</mi><mi>x</mi></mrow><annotation encoding="application/x-tex">sex</annotation></semantics></math>), and their degree of relationship to the proband who is a carrier of the PV. For greater detail on the age imputation approach see documentation.</p></li>
<li><p>For the likelihood calculation monozygous twins can be specified using the <code>twins</code> arguement.</p></li>
</ul>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">twins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ora024"</span>, <span class="st">"ora027"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"aey063"</span>, <span class="st">"aey064"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by BayesMendel Lab, Nicolas Kubista.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
