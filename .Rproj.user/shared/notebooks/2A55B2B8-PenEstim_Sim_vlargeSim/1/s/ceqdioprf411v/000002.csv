"0","dat <- selected_families_weibull_large"
"0",""
"0","#Â Data Preperation in the right format"
"0","for (i in seq_along(dat)) {"
"0","  if (""ID"" %in% colnames(dat[[i]])) {"
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""PedigreeID""] <- ""FamilyID"""
"0","  }"
"0","}"
"0","for (i in seq_along(dat)) {"
"0","  # Add a new column ""PedigreeID"" with the list number"
"0","  dat[[i]]$PedigreeID <- i"
"0","}"
"0","# Change ""isAffCOL"" to ""isAff"" if ""isAffCOL"" is a column"
"0","for (i in seq_along(dat)) {"
"0","  if (""isAffCOL"" %in% colnames(dat[[i]])) {"
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""isAffCOL""] <- ""isAff"""
"0","  }"
"0","}"
"0","for (i in seq_along(dat)) {"
"0","  if (""AgeCOL"" %in% colnames(dat[[i]])) {"
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""AgeCOL""] <- ""Age"""
"0","  }"
"0","}"
"0","for (i in seq_along(dat)) {"
"0","  if (""MLH1"" %in% colnames(dat[[i]])) {"
"0","    colnames(dat[[i]])[colnames(dat[[i]]) == ""MLH1""] <- ""geno"""
"0","  }"
"0","}"
"0","# Set the prior"
"0","prior_params <- list("
"0","    asymptote = list(g1 = 1, g2 = 1),"
"0","    threshold = list(min = 5, max = 40),"
"0","    median = list(m1 = 2, m2 = 2),"
"0","    first_quartile = list(q1 = 6, q2 = 3)"
"0",")"
"0",""
"0","# Use the SEER baseline"
"0","baselineMLH1 <- PPP::PanelPRODatabase$Penetrance[""Colorectal"",""SEER"",""All_Races"",,,""Net""]"
"0","# Adjust Format"
"0","baselineMLH1_df <- as.data.frame(t(baselineMLH1))"
"0","colnames(baselineMLH1_df) <- c(""Female"", ""Male"")"
"0","baselineMLH1_df$Age <- as.numeric(rownames(baselineMLH1_df))"
"0","baselineMLH1_df <- baselineMLH1_df[, c(""Female"", ""Male"")]"
"0",""
"0","#Run Estimation procedure with default prior setting "
"0","#Main Estimation for Female"
"0","system.time(out_sim_COL_MLH1_simLarge<- PenEstim("
"0","    pedigree  = dat, twins = NULL, n_chains = 1, n_iter_per_chain = 10, ncores = 6, baseline_data = baselineMLH1_df , af  = PPP::PanelPRODatabase$AlleleFrequency[paste0(""MLH1"", ""_anyPV""), ""nonAJ""], "
"0","    prior_params = prior_params, burn_in = 0.1, median_max = TRUE,  ageImputation = FALSE, removeProband = FALSE"
"0","))"
"1","Rejection rates: "
"1"," "
"1","0.5"
"1"," "
"1","
"
"1",""
"1","  Median_Male   "
"1"," Median_Female  "
"1"," Threshold_Male "
"1"," Threshold_Female"
"1"," First_Quartile_Male"
"1"," First_Quartile_Female"
"1","
"
"1"," Min.   :57.66  "
"1"," Min.   :44.52  "
"1"," Min.   :38.77  "
"1"," Min.   :28.01   "
"1"," Min.   :46.12      "
"1"," Min.   :34.82        "
"1","
"
"1"," 1st Qu.:59.24  "
"1"," 1st Qu.:44.52  "
"1"," 1st Qu.:39.45  "
"1"," 1st Qu.:28.42   "
"1"," 1st Qu.:47.77      "
"1"," 1st Qu.:35.15        "
"1","
"
"1"," Median :59.25  "
"1"," Median :44.75  "
"1"," Median :39.67  "
"1"," Median :28.54   "
"1"," Median :47.81      "
"1"," Median :35.21        "
"1","
"
"1"," Mean   :59.82  "
"1"," Mean   :44.81  "
"1"," Mean   :39.53  "
"1"," Mean   :28.70   "
"1"," Mean   :47.75      "
"1"," Mean   :35.18        "
"1","
"
"1"," 3rd Qu.:61.32  "
"1"," 3rd Qu.:45.16  "
"1"," 3rd Qu.:39.73  "
"1"," 3rd Qu.:29.29   "
"1"," 3rd Qu.:48.41      "
"1"," 3rd Qu.:35.31        "
"1","
"
"1"," Max.   :61.32  "
"1"," Max.   :45.16  "
"1"," Max.   :39.73  "
"1"," Max.   :29.29   "
"1"," Max.   :48.41      "
"1"," Max.   :35.31        "
"1","
"
"1",""
"1"," Asymptote_Male  "
"1"," Asymptote_Female "
"1","
"
"1"," Min.   :0.1123  "
"1"," Min.   :0.04241  "
"1","
"
"1"," 1st Qu.:0.2540  "
"1"," 1st Qu.:0.04241  "
"1","
"
"1"," Median :0.2953  "
"1"," Median :0.05031  "
"1","
"
"1"," Mean   :0.3336  "
"1"," Mean   :0.05082  "
"1","
"
"1"," 3rd Qu.:0.2953  "
"1"," 3rd Qu.:0.05643  "
"1","
"
"1"," Max.   :0.6333  "
"1"," Max.   :0.06185  "
"1","
"
