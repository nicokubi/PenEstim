"0","# Function to calculate penetrance with confidence intervals"
"0","calculate_penetrance <- function(data, ages = c(30, 40, 50, 60, 65, 70), sex = ""NA"") {"
"0","  params_male <- calculate_weibull_parameters("
"0","    data$median_male_results,"
"0","    data$first_quartile_male_results,"
"0","    data$threshold_male_results"
"0","  )"
"0",""
"0","  params_female <- calculate_weibull_parameters("
"0","    data$median_female_results,"
"0","    data$first_quartile_female_results,"
"0","    data$threshold_female_results"
"0","  )"
"0",""
"0","  alphas_male <- params_male$alpha"
"0","  betas_male <- params_male$beta"
"0","  thresholds_male <- data$threshold_male_results"
"0","  alphas_female <- params_female$alpha"
"0","  betas_female <- params_female$beta"
"0","  thresholds_female <- data$threshold_female_results"
"0",""
"0","  asymptotes_male <- data$asymptote_male_results"
"0","  asymptotes_female <- data$asymptote_female_results"
"0",""
"0","  cumulative_prob <- function(alphas, betas, thresholds, asymptotes, age) {"
"0","    probs <- mapply(function(alpha, beta, threshold, asymptote) {"
"0","      pweibull(age - threshold, shape = alpha, scale = beta) * asymptote"
"0","    }, alphas, betas, thresholds, asymptotes, SIMPLIFY = FALSE)"
"0","    mean_prob <- mean(unlist(probs), na.rm = TRUE)"
"0","    ci_lower <- quantile(unlist(probs), probs = 0.025, na.rm = TRUE)"
"0","    ci_upper <- quantile(unlist(probs), probs = 0.975, na.rm = TRUE)"
"0","    return(list(mean = mean_prob, lower = ci_lower, upper = ci_upper))"
"0","  }"
"0",""
"0","  results <- list()"
"0",""
"0","  if (sex == ""Male"" || sex == ""NA"") {"
"0","    results$Male <- sapply(ages, function(age) cumulative_prob(alphas_male, betas_male, thresholds_male, asymptotes_male, age))"
"0","  }"
"0",""
"0","  if (sex == ""Female"" || sex == ""NA"") {"
"0","    results$Female <- sapply(ages, function(age) cumulative_prob(alphas_female, betas_female, thresholds_female, asymptotes_female, age))"
"0","  }"
"0",""
"0","  return(results)"
"0","}"
"0",""
"0",""
"0","# Calculate penetrance results"
"0","penetrance_results <- calculate_penetrance(dat$combined_chains)"
"0",""
"0","# Format results for LaTeX"
"0","ages <- c(30, 40, 50, 60, 65, 70)"
"0","results_male <- penetrance_results$Male"
"0","results_female <- penetrance_results$Female"
"0",""
"0","print(results_female)"
"1","     "
"1"," [,1]      "
"1"," [,2]      "
"1"," [,3]     "
"1"," [,4]     "
"1"," [,5]     "
"1"," [,6]     "
"1","
mean "
"1"," 0.0265387 "
"1"," 0.09648941"
"1"," 0.205104 "
"1"," 0.3251564"
"1"," 0.3790334"
"1"," 0.4250469"
"1","
lower"
"1"," 0.01279309"
"1"," 0.06401655"
"1"," 0.1582941"
"1"," 0.2566501"
"1"," 0.3009605"
"1"," 0.3369482"
"1","
upper"
"1"," 0.04215776"
"1"," 0.1280071 "
"1"," 0.2578145"
"1"," 0.4014169"
"1"," 0.4630916"
"1"," 0.5105139"
"1","
"
"0","print(results_male)"
"1","     "
"1"," [,1]      "
"1"," [,2]      "
"1"," [,3]     "
"1"," [,4]     "
"1"," [,5]     "
"1"," [,6]     "
"1","
mean "
"1"," 0.02942661"
"1"," 0.1164875 "
"1"," 0.2480978"
"1"," 0.3952154"
"1"," 0.4645404"
"1"," 0.5269951"
"1","
lower"
"1"," 0.01399373"
"1"," 0.07882344"
"1"," 0.1900322"
"1"," 0.3193293"
"1"," 0.3767548"
"1"," 0.4310398"
"1","
upper"
"1"," 0.05050732"
"1"," 0.1593164 "
"1"," 0.307337 "
"1"," 0.4786329"
"1"," 0.5577265"
"1"," 0.6232299"
"1","
"
"0","cat(""\\begin{table}[h]\n"")"
"1","\begin{table}[h]
"
"0","cat(""\\centering\n"")"
"1","\centering
"
"0","cat(""\\begin{tabular}{ccccccc}\n"")"
"1","\begin{tabular}{ccccccc}
"
"0","cat(""\\toprule\n"")"
"1","\toprule
"
"0","cat(""Age & \\multicolumn{3}{c}{Male} & \\multicolumn{3}{c}{Female} \\\\\n"")"
"1","Age & \multicolumn{3}{c}{Male} & \multicolumn{3}{c}{Female} \\
"
"0","cat(""& Probability & Lower CI & Upper CI & Probability & Lower CI & Upper CI \\\\\n"")"
"1","& Probability & Lower CI & Upper CI & Probability & Lower CI & Upper CI \\
"
"0","cat(""\\midrule\n"")"
"1","\midrule
"
"0","for (i in 1:length(ages)) {"
"0","  cat(ages[i], ""&"","
"0","      round(results_male[[i]]$mean * 100, 2), ""&"", "
"0","      round(results_male[[i]]$lower * 100, 2), ""&"", "
"0","      round(results_male[[i]]$upper * 100, 2), ""&"","
"0","      round(results_female[[i]]$mean * 100, 2), ""&"", "
"0","      round(results_female[[i]]$lower * 100, 2), ""&"", "
"0","      round(results_female[[i]]$upper * 100, 2), ""\\\\\n"")"
"0","}"
"2","Error in results_male[[i]]$mean : 
  $ operator is invalid for atomic vectors
"
