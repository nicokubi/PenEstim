"0","# Define Lynch syndrome genes"
"0","lynch_genes <- c(""MLH1"", ""MSH2"", ""MSH6"", ""PMS2"", ""EPCAM"")"
"0","lynch_cancers <- c(""isAffCOL"", ""isAffENDO"", ""isAffOC"")"
"0","lynch_ages <- c(""AgeCOL"", ""AgeENDO"", ""AgeOC"")"
"0",""
"0","# Function to create summary statistics and plots for each gene"
"0","# Function to create summary statistics and plots for each gene"
"0","create_gene_summaries <- function(gene, data) {"
"0",""
"0","  # Filter data for probands who are carriers of the gene"
"0","  carriers <- data[data[[gene]] == 1 & data$isProband == 1, ]"
"0","  carrier_families <- data[data$PedigreeID %in% carriers$PedigreeID, ]"
"0","  "
"0","  # Filter affected individuals"
"0","  affected <- carrier_families[rowSums(carrier_families[lynch_cancers] == 1) > 0, ]"
"0","  "
"0","  # Number of individuals and families"
"0","  num_individuals <- nrow(carrier_families)"
"0","  num_families <- n_distinct(carrier_families$PedigreeID)"
"0","  num_females <- sum(carrier_families$Sex == 0)"
"0","  num_males <- sum(carrier_families$Sex == 1)"
"0","  num_geno_1 <- sum(carrier_families[[gene]] == 1, na.rm = TRUE)"
"0","  num_genotyped <- sum(carrier_families[[gene]] %in% c(0, 1), na.rm = TRUE)"
"0","  "
"0","  # Number of affected individuals for each cancer by gender"
"0","  num_aff_col_female <- sum(carrier_families$isAffCOL == 1 & carrier_families$Sex == 0)"
"0","  num_aff_col_male <- sum(carrier_families$isAffCOL == 1 & carrier_families$Sex == 1)"
"0","  "
"0","  num_aff_endo_female <- sum(carrier_families$isAffENDO == 1 & carrier_families$Sex == 0)"
"0","  num_aff_endo_male <- sum(carrier_families$isAffENDO == 1 & carrier_families$Sex == 1)"
"0","  "
"0","  num_aff_oc_female <- sum(carrier_families$isAffOC == 1 & carrier_families$Sex == 0)"
"0","  num_aff_oc_male <- sum(carrier_families$isAffOC == 1 & carrier_families$Sex == 1)"
"0","  "
"0","  # Print summary"
"0","  cat(""### Summary for gene:"", gene, ""\n"")"
"0","  cat(""  * Number of Families:"", num_families, ""\n"")"
"0","  cat(""  * Number of Individuals:"", num_individuals, ""\n"")"
"0","  cat(""  * Number of Females:"", num_females, ""\n"")"
"0","  cat(""  * Number of Males:"", num_males, ""\n"")"
"0","  cat(""  * Number of Individuals genotyped:"", num_genotyped, ""\n"")"
"0","  cat(""  * Number of Individuals with PV:"", num_geno_1, ""\n"")"
"0","  cat(""  * Number of affected individuals (Colorectal Cancer - Females):"", num_aff_col_female, ""\n"")"
"0","  cat(""  * Number of affected individuals (Colorectal Cancer - Males):"", num_aff_col_male, ""\n"")"
"0","  cat(""  * Number of affected individuals (Endometrial Cancer - Females):"", num_aff_endo_female, ""\n"")"
"0","  cat(""  * Number of affected individuals (Endometrial Cancer - Males):"", num_aff_endo_male, ""\n"")"
"0","  cat(""  * Number of affected individuals (Ovarian Cancer - Females):"", num_aff_oc_female, ""\n"")"
"0","  cat(""  * Number of affected individuals (Ovarian Cancer - Males):"", num_aff_oc_male, ""\n"")"
"0","  "
"0","  # Create a grid of histograms for age distributions"
"0","  library(gridExtra)"
"0","  p1 <- ggplot(affected, aes(x = AgeCOL)) +"
"0","    geom_histogram(binwidth = 5, fill = ""blue"", color = ""black"") +"
"0","    labs(title = paste(""Colorectal Cancer"", x = ""Age at Diagnosis"", y = ""Count"")) +"
"0","    theme_minimal()"
"0","  "
"0","  p2 <- ggplot(affected, aes(x = AgeENDO)) +"
"0","    geom_histogram(binwidth = 5, fill = ""green"", color = ""black"") +"
"0","    labs(title = paste(""Endometrial Cancer"", x = ""Age at Diagnosis"", y = ""Count"")) +"
"0","    theme_minimal()"
"0","  "
"0","  p3 <- ggplot(affected, aes(x = AgeOC)) +"
"0","    geom_histogram(binwidth = 5, fill = ""red"", color = ""black"") +"
"0","    labs(title = paste(""Ovarian Cancer"", x = ""Age at Diagnosis"", y = ""Count"")) +"
"0","    theme_minimal()"
"0","  "
"0","  grid.arrange(p1, p2, p3, ncol = 1)"
"0","}"
